{"paragraphs":[{"text":"%md\n##DEMO LLAP ACCESS THROUGH SPARK THRIFT SERVER","dateUpdated":"2016-12-21T20:42:25+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/markdown","editorHide":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482352901292_471488732","id":"20161221-204141_1036589899","result":{"code":"SUCCESS","type":"HTML","msg":"<h2>DEMO LLAP ACCESS THROUGH SPARK THRIFT SERVER</h2>\n"},"dateCreated":"2016-12-21T20:41:41+0000","dateStarted":"2016-12-21T20:42:05+0000","dateFinished":"2016-12-21T20:42:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2842"},{"title":"HiveAccessControlException: Permission denied: user [spark] does not have [SELECT] privilege ","text":"%jdbc(spark)\n\nselect storekey, productkey, salesamount from factsales limit 10","dateUpdated":"2016-12-21T20:40:45+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482352730286_300261792","id":"20161221-203850_1440622646","result":{"code":"ERROR","type":"TEXT","msg":"java.io.IOException: org.apache.hive.service.cli.HiveSQLException: java.io.IOException: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to compile query: org.apache.hadoop.hive.ql.security.authorization.plugin.HiveAccessControlException: Permission denied: user [spark] does not have [SELECT] privilege on [default/factsales/productkey,salesamount,storekey]\nclass java.sql.SQLException\norg.apache.hive.jdbc.HiveStatement.execute(HiveStatement.java:283)\norg.apache.zeppelin.jdbc.JDBCInterpreter.executeSql(JDBCInterpreter.java:356)\norg.apache.zeppelin.jdbc.JDBCInterpreter.interpret(JDBCInterpreter.java:442)\norg.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:94)\norg.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:341)\norg.apache.zeppelin.scheduler.Job.run(Job.java:176)\norg.apache.zeppelin.scheduler.ParallelScheduler$JobRunner.run(ParallelScheduler.java:162)\njava.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\njava.util.concurrent.FutureTask.run(FutureTask.java:266)\njava.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\njava.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\njava.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\njava.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\njava.lang.Thread.run(Thread.java:745)"},"dateCreated":"2016-12-21T20:38:50+0000","dateStarted":"2016-12-21T20:39:50+0000","dateFinished":"2016-12-21T20:39:55+0000","status":"ERROR","progressUpdateIntervalMs":500,"$$hashKey":"object:2843"},{"title":"Ranger Masking Policy Applied for user \"spark\"","text":"%jdbc(spark)\n\nselect  productkey, salesamount from factsales limit 10","dateUpdated":"2016-12-21T20:48:58+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"productkey","index":0,"aggr":"sum"}],"values":[{"name":"salesamount","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"productkey","index":0,"aggr":"sum"},"yAxis":{"name":"salesamount","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482352790883_-830671756","id":"20161221-203950_958487852","result":{"code":"SUCCESS","type":"TABLE","msg":"productkey\tsalesamount\n70\tnull\n52\tnull\n31\tnull\n3\tnull\n96\tnull\n1\tnull\n18\tnull\n97\tnull\n46\tnull\n15\tnull\n","comment":"","msgTable":[[{"key":"salesamount","value":"70"},{"key":"salesamount","value":"null"}],[{"value":"52"},{"value":"null"}],[{"value":"31"},{"value":"null"}],[{"value":"3"},{"value":"null"}],[{"value":"96"},{"value":"null"}],[{"value":"1"},{"value":"null"}],[{"value":"18"},{"value":"null"}],[{"value":"97"},{"value":"null"}],[{"value":"46"},{"value":"null"}],[{"value":"15"},{"value":"null"}]],"columnNames":[{"name":"productkey","index":0,"aggr":"sum"},{"name":"salesamount","index":1,"aggr":"sum"}],"rows":[["70","null"],["52","null"],["31","null"],["3","null"],["96","null"],["1","null"],["18","null"],["97","null"],["46","null"],["15","null"]]},"dateCreated":"2016-12-21T20:39:50+0000","dateStarted":"2016-12-21T20:48:58+0000","dateFinished":"2016-12-21T20:49:13+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2844"},{"title":"Spark Thrift Server call using \"hive\" user","text":"%jdbc(spark-hive)\n\nselect  productkey, salesamount from factsales limit 10","dateUpdated":"2016-12-21T20:48:44+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482352819379_-138862586","id":"20161221-204019_820673805","result":{"code":"SUCCESS","type":"TABLE","msg":"productkey\tsalesamount\n1232\t10469.51953125\n785\t83.5999984741211\n2132\t573.6500244140625\n1209\t8800.0\n641\t3112.39990234375\n1542\t3300.0\n540\t21491.400390625\n1641\t126.5999984741211\n2209\t2736.881103515625\n1885\t7995.0\n","comment":"","msgTable":[[{"key":"salesamount","value":"1232"},{"key":"salesamount","value":"10469.51953125"}],[{"value":"785"},{"value":"83.5999984741211"}],[{"value":"2132"},{"value":"573.6500244140625"}],[{"value":"1209"},{"value":"8800.0"}],[{"value":"641"},{"value":"3112.39990234375"}],[{"value":"1542"},{"value":"3300.0"}],[{"value":"540"},{"value":"21491.400390625"}],[{"value":"1641"},{"value":"126.5999984741211"}],[{"value":"2209"},{"value":"2736.881103515625"}],[{"value":"1885"},{"value":"7995.0"}]],"columnNames":[{"name":"productkey","index":0,"aggr":"sum"},{"name":"salesamount","index":1,"aggr":"sum"}],"rows":[["1232","10469.51953125"],["785","83.5999984741211"],["2132","573.6500244140625"],["1209","8800.0"],["641","3112.39990234375"],["1542","3300.0"],["540","21491.400390625"],["1641","126.5999984741211"],["2209","2736.881103515625"],["1885","7995.0"]]},"dateCreated":"2016-12-21T20:40:19+0000","dateStarted":"2016-12-21T20:42:59+0000","dateFinished":"2016-12-21T20:43:15+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2845"},{"text":"%jdbc(spark-hive)\n\nselect * from factsales limit 10","dateUpdated":"2016-12-21T20:45:59+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482352979619_434876290","id":"20161221-204259_1900365806","result":{"code":"SUCCESS","type":"TABLE","msg":"saleskey\tdatekey\tchannelkey\tstorekey\tproductkey\tpromotionkey\tcurrencykey\tunitcost\tunitprice\tsalesquantity\treturnquantity\treturnamount\tdiscountquantity\tdiscountamount\ttotalcost\tsalesamount\tetlloadid\tloaddate\tupdatedate\n3326037\t2007-03-18 00:00:00.0\t2\t306\t1232\t8\t1\t408.3599853515625\t888.0\t12\t0\t0.0\t3\t186.47999572753906\t4900.31982421875\t10469.51953125\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3346043\t2009-02-19 00:00:00.0\t1\t178\t785\t20\t1\t4.369999885559082\t9.5\t9\t1\t9.5\t4\t1.899999976158142\t34.959999084472656\t83.5999984741211\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3326044\t2007-01-07 00:00:00.0\t1\t187\t2132\t2\t1\t75.95999908447266\t149.0\t4\t0\t0.0\t3\t22.350000381469727\t303.8399963378906\t573.6500244140625\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3397507\t2007-05-20 00:00:00.0\t1\t148\t1209\t1\t1\t404.67999267578125\t880.0\t10\t0\t0.0\t0\t0.0\t4046.800048828125\t8800.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3346036\t2008-11-09 00:00:00.0\t1\t259\t641\t14\t1\t115.43000030517578\t251.0\t13\t0\t0.0\t4\t150.60000610351562\t1500.5899658203125\t3112.39990234375\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3326051\t2007-05-15 00:00:00.0\t1\t305\t1542\t1\t1\t151.75999450683594\t330.0\t10\t0\t0.0\t0\t0.0\t1517.5999755859375\t3300.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3346029\t2007-09-20 00:00:00.0\t1\t238\t540\t9\t1\t827.969970703125\t2499.0\t9\t0\t0.0\t4\t999.5999755859375\t7451.72998046875\t21491.400390625\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3326058\t2007-07-04 00:00:00.0\t1\t236\t1641\t1\t1\t5.820000171661377\t12.65999984741211\t10\t1\t12.65999984741211\t0\t0.0\t52.380001068115234\t126.5999984741211\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3274580\t2008-08-15 00:00:00.0\t1\t128\t2209\t12\t1\t105.76000213623047\t229.99000549316406\t12\t0\t0.0\t1\t22.999000549316406\t1269.1199951171875\t2736.881103515625\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3346022\t2007-09-29 00:00:00.0\t1\t268\t1885\t1\t1\t815.219970703125\t1599.0\t5\t0\t0.0\t0\t0.0\t4076.10009765625\t7995.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n","comment":"","msgTable":[[{"key":"datekey","value":"3326037"},{"key":"datekey","value":"2007-03-18 00:00:00.0"},{"key":"datekey","value":"2"},{"key":"datekey","value":"306"},{"key":"datekey","value":"1232"},{"key":"datekey","value":"8"},{"key":"datekey","value":"1"},{"key":"datekey","value":"408.3599853515625"},{"key":"datekey","value":"888.0"},{"key":"datekey","value":"12"},{"key":"datekey","value":"0"},{"key":"datekey","value":"0.0"},{"key":"datekey","value":"3"},{"key":"datekey","value":"186.47999572753906"},{"key":"datekey","value":"4900.31982421875"},{"key":"datekey","value":"10469.51953125"},{"key":"datekey","value":"1"},{"key":"datekey","value":"2010-01-01 00:00:00.0"},{"key":"datekey","value":"2010-01-01 00:00:00.0"}],[{"key":"channelkey","value":"3346043"},{"key":"channelkey","value":"2009-02-19 00:00:00.0"},{"key":"channelkey","value":"1"},{"key":"channelkey","value":"178"},{"key":"channelkey","value":"785"},{"key":"channelkey","value":"20"},{"key":"channelkey","value":"1"},{"key":"channelkey","value":"4.369999885559082"},{"key":"channelkey","value":"9.5"},{"key":"channelkey","value":"9"},{"key":"channelkey","value":"1"},{"key":"channelkey","value":"9.5"},{"key":"channelkey","value":"4"},{"key":"channelkey","value":"1.899999976158142"},{"key":"channelkey","value":"34.959999084472656"},{"key":"channelkey","value":"83.5999984741211"},{"key":"channelkey","value":"1"},{"key":"channelkey","value":"2010-01-01 00:00:00.0"},{"key":"channelkey","value":"2010-01-01 00:00:00.0"}],[{"key":"storekey","value":"3326044"},{"key":"storekey","value":"2007-01-07 00:00:00.0"},{"key":"storekey","value":"1"},{"key":"storekey","value":"187"},{"key":"storekey","value":"2132"},{"key":"storekey","value":"2"},{"key":"storekey","value":"1"},{"key":"storekey","value":"75.95999908447266"},{"key":"storekey","value":"149.0"},{"key":"storekey","value":"4"},{"key":"storekey","value":"0"},{"key":"storekey","value":"0.0"},{"key":"storekey","value":"3"},{"key":"storekey","value":"22.350000381469727"},{"key":"storekey","value":"303.8399963378906"},{"key":"storekey","value":"573.6500244140625"},{"key":"storekey","value":"1"},{"key":"storekey","value":"2010-01-01 00:00:00.0"},{"key":"storekey","value":"2010-01-01 00:00:00.0"}],[{"key":"productkey","value":"3397507"},{"key":"productkey","value":"2007-05-20 00:00:00.0"},{"key":"productkey","value":"1"},{"key":"productkey","value":"148"},{"key":"productkey","value":"1209"},{"key":"productkey","value":"1"},{"key":"productkey","value":"1"},{"key":"productkey","value":"404.67999267578125"},{"key":"productkey","value":"880.0"},{"key":"productkey","value":"10"},{"key":"productkey","value":"0"},{"key":"productkey","value":"0.0"},{"key":"productkey","value":"0"},{"key":"productkey","value":"0.0"},{"key":"productkey","value":"4046.800048828125"},{"key":"productkey","value":"8800.0"},{"key":"productkey","value":"1"},{"key":"productkey","value":"2010-01-01 00:00:00.0"},{"key":"productkey","value":"2010-01-01 00:00:00.0"}],[{"key":"promotionkey","value":"3346036"},{"key":"promotionkey","value":"2008-11-09 00:00:00.0"},{"key":"promotionkey","value":"1"},{"key":"promotionkey","value":"259"},{"key":"promotionkey","value":"641"},{"key":"promotionkey","value":"14"},{"key":"promotionkey","value":"1"},{"key":"promotionkey","value":"115.43000030517578"},{"key":"promotionkey","value":"251.0"},{"key":"promotionkey","value":"13"},{"key":"promotionkey","value":"0"},{"key":"promotionkey","value":"0.0"},{"key":"promotionkey","value":"4"},{"key":"promotionkey","value":"150.60000610351562"},{"key":"promotionkey","value":"1500.5899658203125"},{"key":"promotionkey","value":"3112.39990234375"},{"key":"promotionkey","value":"1"},{"key":"promotionkey","value":"2010-01-01 00:00:00.0"},{"key":"promotionkey","value":"2010-01-01 00:00:00.0"}],[{"key":"currencykey","value":"3326051"},{"key":"currencykey","value":"2007-05-15 00:00:00.0"},{"key":"currencykey","value":"1"},{"key":"currencykey","value":"305"},{"key":"currencykey","value":"1542"},{"key":"currencykey","value":"1"},{"key":"currencykey","value":"1"},{"key":"currencykey","value":"151.75999450683594"},{"key":"currencykey","value":"330.0"},{"key":"currencykey","value":"10"},{"key":"currencykey","value":"0"},{"key":"currencykey","value":"0.0"},{"key":"currencykey","value":"0"},{"key":"currencykey","value":"0.0"},{"key":"currencykey","value":"1517.5999755859375"},{"key":"currencykey","value":"3300.0"},{"key":"currencykey","value":"1"},{"key":"currencykey","value":"2010-01-01 00:00:00.0"},{"key":"currencykey","value":"2010-01-01 00:00:00.0"}],[{"key":"unitcost","value":"3346029"},{"key":"unitcost","value":"2007-09-20 00:00:00.0"},{"key":"unitcost","value":"1"},{"key":"unitcost","value":"238"},{"key":"unitcost","value":"540"},{"key":"unitcost","value":"9"},{"key":"unitcost","value":"1"},{"key":"unitcost","value":"827.969970703125"},{"key":"unitcost","value":"2499.0"},{"key":"unitcost","value":"9"},{"key":"unitcost","value":"0"},{"key":"unitcost","value":"0.0"},{"key":"unitcost","value":"4"},{"key":"unitcost","value":"999.5999755859375"},{"key":"unitcost","value":"7451.72998046875"},{"key":"unitcost","value":"21491.400390625"},{"key":"unitcost","value":"1"},{"key":"unitcost","value":"2010-01-01 00:00:00.0"},{"key":"unitcost","value":"2010-01-01 00:00:00.0"}],[{"key":"unitprice","value":"3326058"},{"key":"unitprice","value":"2007-07-04 00:00:00.0"},{"key":"unitprice","value":"1"},{"key":"unitprice","value":"236"},{"key":"unitprice","value":"1641"},{"key":"unitprice","value":"1"},{"key":"unitprice","value":"1"},{"key":"unitprice","value":"5.820000171661377"},{"key":"unitprice","value":"12.65999984741211"},{"key":"unitprice","value":"10"},{"key":"unitprice","value":"1"},{"key":"unitprice","value":"12.65999984741211"},{"key":"unitprice","value":"0"},{"key":"unitprice","value":"0.0"},{"key":"unitprice","value":"52.380001068115234"},{"key":"unitprice","value":"126.5999984741211"},{"key":"unitprice","value":"1"},{"key":"unitprice","value":"2010-01-01 00:00:00.0"},{"key":"unitprice","value":"2010-01-01 00:00:00.0"}],[{"key":"salesquantity","value":"3274580"},{"key":"salesquantity","value":"2008-08-15 00:00:00.0"},{"key":"salesquantity","value":"1"},{"key":"salesquantity","value":"128"},{"key":"salesquantity","value":"2209"},{"key":"salesquantity","value":"12"},{"key":"salesquantity","value":"1"},{"key":"salesquantity","value":"105.76000213623047"},{"key":"salesquantity","value":"229.99000549316406"},{"key":"salesquantity","value":"12"},{"key":"salesquantity","value":"0"},{"key":"salesquantity","value":"0.0"},{"key":"salesquantity","value":"1"},{"key":"salesquantity","value":"22.999000549316406"},{"key":"salesquantity","value":"1269.1199951171875"},{"key":"salesquantity","value":"2736.881103515625"},{"key":"salesquantity","value":"1"},{"key":"salesquantity","value":"2010-01-01 00:00:00.0"},{"key":"salesquantity","value":"2010-01-01 00:00:00.0"}],[{"key":"returnquantity","value":"3346022"},{"key":"returnquantity","value":"2007-09-29 00:00:00.0"},{"key":"returnquantity","value":"1"},{"key":"returnquantity","value":"268"},{"key":"returnquantity","value":"1885"},{"key":"returnquantity","value":"1"},{"key":"returnquantity","value":"1"},{"key":"returnquantity","value":"815.219970703125"},{"key":"returnquantity","value":"1599.0"},{"key":"returnquantity","value":"5"},{"key":"returnquantity","value":"0"},{"key":"returnquantity","value":"0.0"},{"key":"returnquantity","value":"0"},{"key":"returnquantity","value":"0.0"},{"key":"returnquantity","value":"4076.10009765625"},{"key":"returnquantity","value":"7995.0"},{"key":"returnquantity","value":"1"},{"key":"returnquantity","value":"2010-01-01 00:00:00.0"},{"key":"returnquantity","value":"2010-01-01 00:00:00.0"}]],"columnNames":[{"name":"saleskey","index":0,"aggr":"sum"},{"name":"datekey","index":1,"aggr":"sum"},{"name":"channelkey","index":2,"aggr":"sum"},{"name":"storekey","index":3,"aggr":"sum"},{"name":"productkey","index":4,"aggr":"sum"},{"name":"promotionkey","index":5,"aggr":"sum"},{"name":"currencykey","index":6,"aggr":"sum"},{"name":"unitcost","index":7,"aggr":"sum"},{"name":"unitprice","index":8,"aggr":"sum"},{"name":"salesquantity","index":9,"aggr":"sum"},{"name":"returnquantity","index":10,"aggr":"sum"},{"name":"returnamount","index":11,"aggr":"sum"},{"name":"discountquantity","index":12,"aggr":"sum"},{"name":"discountamount","index":13,"aggr":"sum"},{"name":"totalcost","index":14,"aggr":"sum"},{"name":"salesamount","index":15,"aggr":"sum"},{"name":"etlloadid","index":16,"aggr":"sum"},{"name":"loaddate","index":17,"aggr":"sum"},{"name":"updatedate","index":18,"aggr":"sum"}],"rows":[["3326037","2007-03-18 00:00:00.0","2","306","1232","8","1","408.3599853515625","888.0","12","0","0.0","3","186.47999572753906","4900.31982421875","10469.51953125","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3346043","2009-02-19 00:00:00.0","1","178","785","20","1","4.369999885559082","9.5","9","1","9.5","4","1.899999976158142","34.959999084472656","83.5999984741211","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3326044","2007-01-07 00:00:00.0","1","187","2132","2","1","75.95999908447266","149.0","4","0","0.0","3","22.350000381469727","303.8399963378906","573.6500244140625","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3397507","2007-05-20 00:00:00.0","1","148","1209","1","1","404.67999267578125","880.0","10","0","0.0","0","0.0","4046.800048828125","8800.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3346036","2008-11-09 00:00:00.0","1","259","641","14","1","115.43000030517578","251.0","13","0","0.0","4","150.60000610351562","1500.5899658203125","3112.39990234375","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3326051","2007-05-15 00:00:00.0","1","305","1542","1","1","151.75999450683594","330.0","10","0","0.0","0","0.0","1517.5999755859375","3300.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3346029","2007-09-20 00:00:00.0","1","238","540","9","1","827.969970703125","2499.0","9","0","0.0","4","999.5999755859375","7451.72998046875","21491.400390625","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3326058","2007-07-04 00:00:00.0","1","236","1641","1","1","5.820000171661377","12.65999984741211","10","1","12.65999984741211","0","0.0","52.380001068115234","126.5999984741211","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3274580","2008-08-15 00:00:00.0","1","128","2209","12","1","105.76000213623047","229.99000549316406","12","0","0.0","1","22.999000549316406","1269.1199951171875","2736.881103515625","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3346022","2007-09-29 00:00:00.0","1","268","1885","1","1","815.219970703125","1599.0","5","0","0.0","0","0.0","4076.10009765625","7995.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"]]},"dateCreated":"2016-12-21T20:42:59+0000","dateStarted":"2016-12-21T20:45:59+0000","dateFinished":"2016-12-21T20:46:14+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2846"},{"title":"Plain HIVE JDBC Connection using Hive User","text":"%jdbc(hive)\n\nselect * from factsales limit 10","dateUpdated":"2016-12-21T20:47:43+0000","config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[{"name":"factsales.saleskey","index":0,"aggr":"sum"}],"values":[{"name":"factsales.datekey","index":1,"aggr":"sum"}],"groups":[],"scatter":{"xAxis":{"name":"factsales.saleskey","index":0,"aggr":"sum"},"yAxis":{"name":"factsales.datekey","index":1,"aggr":"sum"}}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482353159702_1468159117","id":"20161221-204559_1141254623","result":{"code":"SUCCESS","type":"TABLE","msg":"factsales.saleskey\tfactsales.datekey\tfactsales.channelkey\tfactsales.storekey\tfactsales.productkey\tfactsales.promotionkey\tfactsales.currencykey\tfactsales.unitcost\tfactsales.unitprice\tfactsales.salesquantity\tfactsales.returnquantity\tfactsales.returnamount\tfactsales.discountquantity\tfactsales.discountamount\tfactsales.totalcost\tfactsales.salesamount\tfactsales.etlloadid\tfactsales.loaddate\tfactsales.updatedate\n3328262\t2008-02-08 00:00:00.0\t2\t306\t625\t17\t1\t459.4\t999.0\t12\t0\t0.0\t0\t0.0\t5512.8\t11988.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3386075\t2009-10-20 00:00:00.0\t2\t199\t851\t1\t1\t76.5\t230.9\t20\t1\t230.9\t0\t0.0\t1453.5\t4618.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3366069\t2007-08-12 00:00:00.0\t1\t242\t2174\t9\t1\t75.96\t149.0\t4\t0\t0.0\t3\t44.7\t303.84\t551.3\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3319365\t2009-07-12 00:00:00.0\t2\t307\t966\t1\t1\t84.84\t184.5\t24\t0\t0.0\t0\t0.0\t2036.16\t4428.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3286017\t2008-02-28 00:00:00.0\t1\t209\t303\t17\t1\t287.92\t869.0\t12\t0\t0.0\t4\t243.32\t3455.04\t10184.68\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3397618\t2007-12-19 00:00:00.0\t1\t31\t972\t4\t1\t59.32\t129.0\t6\t0\t0.0\t4\t103.2\t355.92\t670.8\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3306016\t2009-07-24 00:00:00.0\t1\t1\t679\t21\t1\t39.77\t78.0\t24\t0\t0.0\t0\t0.0\t954.48\t1872.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3268860\t2007-01-14 00:00:00.0\t1\t9\t2220\t2\t1\t40.76\t79.95\t4\t0\t0.0\t3\t11.9925\t163.04\t307.8075\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3386068\t2007-10-23 00:00:00.0\t2\t307\t817\t1\t1\t4.84\t9.5\t15\t0\t0.0\t0\t0.0\t72.6\t142.5\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n3366076\t2009-04-15 00:00:00.0\t1\t101\t684\t1\t1\t73.58\t160.0\t10\t0\t0.0\t0\t0.0\t735.8\t1600.0\t1\t2010-01-01 00:00:00.0\t2010-01-01 00:00:00.0\n","comment":"","msgTable":[[{"key":"factsales.datekey","value":"3328262"},{"key":"factsales.datekey","value":"2008-02-08 00:00:00.0"},{"key":"factsales.datekey","value":"2"},{"key":"factsales.datekey","value":"306"},{"key":"factsales.datekey","value":"625"},{"key":"factsales.datekey","value":"17"},{"key":"factsales.datekey","value":"1"},{"key":"factsales.datekey","value":"459.4"},{"key":"factsales.datekey","value":"999.0"},{"key":"factsales.datekey","value":"12"},{"key":"factsales.datekey","value":"0"},{"key":"factsales.datekey","value":"0.0"},{"key":"factsales.datekey","value":"0"},{"key":"factsales.datekey","value":"0.0"},{"key":"factsales.datekey","value":"5512.8"},{"key":"factsales.datekey","value":"11988.0"},{"key":"factsales.datekey","value":"1"},{"key":"factsales.datekey","value":"2010-01-01 00:00:00.0"},{"key":"factsales.datekey","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.channelkey","value":"3386075"},{"key":"factsales.channelkey","value":"2009-10-20 00:00:00.0"},{"key":"factsales.channelkey","value":"2"},{"key":"factsales.channelkey","value":"199"},{"key":"factsales.channelkey","value":"851"},{"key":"factsales.channelkey","value":"1"},{"key":"factsales.channelkey","value":"1"},{"key":"factsales.channelkey","value":"76.5"},{"key":"factsales.channelkey","value":"230.9"},{"key":"factsales.channelkey","value":"20"},{"key":"factsales.channelkey","value":"1"},{"key":"factsales.channelkey","value":"230.9"},{"key":"factsales.channelkey","value":"0"},{"key":"factsales.channelkey","value":"0.0"},{"key":"factsales.channelkey","value":"1453.5"},{"key":"factsales.channelkey","value":"4618.0"},{"key":"factsales.channelkey","value":"1"},{"key":"factsales.channelkey","value":"2010-01-01 00:00:00.0"},{"key":"factsales.channelkey","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.storekey","value":"3366069"},{"key":"factsales.storekey","value":"2007-08-12 00:00:00.0"},{"key":"factsales.storekey","value":"1"},{"key":"factsales.storekey","value":"242"},{"key":"factsales.storekey","value":"2174"},{"key":"factsales.storekey","value":"9"},{"key":"factsales.storekey","value":"1"},{"key":"factsales.storekey","value":"75.96"},{"key":"factsales.storekey","value":"149.0"},{"key":"factsales.storekey","value":"4"},{"key":"factsales.storekey","value":"0"},{"key":"factsales.storekey","value":"0.0"},{"key":"factsales.storekey","value":"3"},{"key":"factsales.storekey","value":"44.7"},{"key":"factsales.storekey","value":"303.84"},{"key":"factsales.storekey","value":"551.3"},{"key":"factsales.storekey","value":"1"},{"key":"factsales.storekey","value":"2010-01-01 00:00:00.0"},{"key":"factsales.storekey","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.productkey","value":"3319365"},{"key":"factsales.productkey","value":"2009-07-12 00:00:00.0"},{"key":"factsales.productkey","value":"2"},{"key":"factsales.productkey","value":"307"},{"key":"factsales.productkey","value":"966"},{"key":"factsales.productkey","value":"1"},{"key":"factsales.productkey","value":"1"},{"key":"factsales.productkey","value":"84.84"},{"key":"factsales.productkey","value":"184.5"},{"key":"factsales.productkey","value":"24"},{"key":"factsales.productkey","value":"0"},{"key":"factsales.productkey","value":"0.0"},{"key":"factsales.productkey","value":"0"},{"key":"factsales.productkey","value":"0.0"},{"key":"factsales.productkey","value":"2036.16"},{"key":"factsales.productkey","value":"4428.0"},{"key":"factsales.productkey","value":"1"},{"key":"factsales.productkey","value":"2010-01-01 00:00:00.0"},{"key":"factsales.productkey","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.promotionkey","value":"3286017"},{"key":"factsales.promotionkey","value":"2008-02-28 00:00:00.0"},{"key":"factsales.promotionkey","value":"1"},{"key":"factsales.promotionkey","value":"209"},{"key":"factsales.promotionkey","value":"303"},{"key":"factsales.promotionkey","value":"17"},{"key":"factsales.promotionkey","value":"1"},{"key":"factsales.promotionkey","value":"287.92"},{"key":"factsales.promotionkey","value":"869.0"},{"key":"factsales.promotionkey","value":"12"},{"key":"factsales.promotionkey","value":"0"},{"key":"factsales.promotionkey","value":"0.0"},{"key":"factsales.promotionkey","value":"4"},{"key":"factsales.promotionkey","value":"243.32"},{"key":"factsales.promotionkey","value":"3455.04"},{"key":"factsales.promotionkey","value":"10184.68"},{"key":"factsales.promotionkey","value":"1"},{"key":"factsales.promotionkey","value":"2010-01-01 00:00:00.0"},{"key":"factsales.promotionkey","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.currencykey","value":"3397618"},{"key":"factsales.currencykey","value":"2007-12-19 00:00:00.0"},{"key":"factsales.currencykey","value":"1"},{"key":"factsales.currencykey","value":"31"},{"key":"factsales.currencykey","value":"972"},{"key":"factsales.currencykey","value":"4"},{"key":"factsales.currencykey","value":"1"},{"key":"factsales.currencykey","value":"59.32"},{"key":"factsales.currencykey","value":"129.0"},{"key":"factsales.currencykey","value":"6"},{"key":"factsales.currencykey","value":"0"},{"key":"factsales.currencykey","value":"0.0"},{"key":"factsales.currencykey","value":"4"},{"key":"factsales.currencykey","value":"103.2"},{"key":"factsales.currencykey","value":"355.92"},{"key":"factsales.currencykey","value":"670.8"},{"key":"factsales.currencykey","value":"1"},{"key":"factsales.currencykey","value":"2010-01-01 00:00:00.0"},{"key":"factsales.currencykey","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.unitcost","value":"3306016"},{"key":"factsales.unitcost","value":"2009-07-24 00:00:00.0"},{"key":"factsales.unitcost","value":"1"},{"key":"factsales.unitcost","value":"1"},{"key":"factsales.unitcost","value":"679"},{"key":"factsales.unitcost","value":"21"},{"key":"factsales.unitcost","value":"1"},{"key":"factsales.unitcost","value":"39.77"},{"key":"factsales.unitcost","value":"78.0"},{"key":"factsales.unitcost","value":"24"},{"key":"factsales.unitcost","value":"0"},{"key":"factsales.unitcost","value":"0.0"},{"key":"factsales.unitcost","value":"0"},{"key":"factsales.unitcost","value":"0.0"},{"key":"factsales.unitcost","value":"954.48"},{"key":"factsales.unitcost","value":"1872.0"},{"key":"factsales.unitcost","value":"1"},{"key":"factsales.unitcost","value":"2010-01-01 00:00:00.0"},{"key":"factsales.unitcost","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.unitprice","value":"3268860"},{"key":"factsales.unitprice","value":"2007-01-14 00:00:00.0"},{"key":"factsales.unitprice","value":"1"},{"key":"factsales.unitprice","value":"9"},{"key":"factsales.unitprice","value":"2220"},{"key":"factsales.unitprice","value":"2"},{"key":"factsales.unitprice","value":"1"},{"key":"factsales.unitprice","value":"40.76"},{"key":"factsales.unitprice","value":"79.95"},{"key":"factsales.unitprice","value":"4"},{"key":"factsales.unitprice","value":"0"},{"key":"factsales.unitprice","value":"0.0"},{"key":"factsales.unitprice","value":"3"},{"key":"factsales.unitprice","value":"11.9925"},{"key":"factsales.unitprice","value":"163.04"},{"key":"factsales.unitprice","value":"307.8075"},{"key":"factsales.unitprice","value":"1"},{"key":"factsales.unitprice","value":"2010-01-01 00:00:00.0"},{"key":"factsales.unitprice","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.salesquantity","value":"3386068"},{"key":"factsales.salesquantity","value":"2007-10-23 00:00:00.0"},{"key":"factsales.salesquantity","value":"2"},{"key":"factsales.salesquantity","value":"307"},{"key":"factsales.salesquantity","value":"817"},{"key":"factsales.salesquantity","value":"1"},{"key":"factsales.salesquantity","value":"1"},{"key":"factsales.salesquantity","value":"4.84"},{"key":"factsales.salesquantity","value":"9.5"},{"key":"factsales.salesquantity","value":"15"},{"key":"factsales.salesquantity","value":"0"},{"key":"factsales.salesquantity","value":"0.0"},{"key":"factsales.salesquantity","value":"0"},{"key":"factsales.salesquantity","value":"0.0"},{"key":"factsales.salesquantity","value":"72.6"},{"key":"factsales.salesquantity","value":"142.5"},{"key":"factsales.salesquantity","value":"1"},{"key":"factsales.salesquantity","value":"2010-01-01 00:00:00.0"},{"key":"factsales.salesquantity","value":"2010-01-01 00:00:00.0"}],[{"key":"factsales.returnquantity","value":"3366076"},{"key":"factsales.returnquantity","value":"2009-04-15 00:00:00.0"},{"key":"factsales.returnquantity","value":"1"},{"key":"factsales.returnquantity","value":"101"},{"key":"factsales.returnquantity","value":"684"},{"key":"factsales.returnquantity","value":"1"},{"key":"factsales.returnquantity","value":"1"},{"key":"factsales.returnquantity","value":"73.58"},{"key":"factsales.returnquantity","value":"160.0"},{"key":"factsales.returnquantity","value":"10"},{"key":"factsales.returnquantity","value":"0"},{"key":"factsales.returnquantity","value":"0.0"},{"key":"factsales.returnquantity","value":"0"},{"key":"factsales.returnquantity","value":"0.0"},{"key":"factsales.returnquantity","value":"735.8"},{"key":"factsales.returnquantity","value":"1600.0"},{"key":"factsales.returnquantity","value":"1"},{"key":"factsales.returnquantity","value":"2010-01-01 00:00:00.0"},{"key":"factsales.returnquantity","value":"2010-01-01 00:00:00.0"}]],"columnNames":[{"name":"factsales.saleskey","index":0,"aggr":"sum"},{"name":"factsales.datekey","index":1,"aggr":"sum"},{"name":"factsales.channelkey","index":2,"aggr":"sum"},{"name":"factsales.storekey","index":3,"aggr":"sum"},{"name":"factsales.productkey","index":4,"aggr":"sum"},{"name":"factsales.promotionkey","index":5,"aggr":"sum"},{"name":"factsales.currencykey","index":6,"aggr":"sum"},{"name":"factsales.unitcost","index":7,"aggr":"sum"},{"name":"factsales.unitprice","index":8,"aggr":"sum"},{"name":"factsales.salesquantity","index":9,"aggr":"sum"},{"name":"factsales.returnquantity","index":10,"aggr":"sum"},{"name":"factsales.returnamount","index":11,"aggr":"sum"},{"name":"factsales.discountquantity","index":12,"aggr":"sum"},{"name":"factsales.discountamount","index":13,"aggr":"sum"},{"name":"factsales.totalcost","index":14,"aggr":"sum"},{"name":"factsales.salesamount","index":15,"aggr":"sum"},{"name":"factsales.etlloadid","index":16,"aggr":"sum"},{"name":"factsales.loaddate","index":17,"aggr":"sum"},{"name":"factsales.updatedate","index":18,"aggr":"sum"}],"rows":[["3328262","2008-02-08 00:00:00.0","2","306","625","17","1","459.4","999.0","12","0","0.0","0","0.0","5512.8","11988.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3386075","2009-10-20 00:00:00.0","2","199","851","1","1","76.5","230.9","20","1","230.9","0","0.0","1453.5","4618.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3366069","2007-08-12 00:00:00.0","1","242","2174","9","1","75.96","149.0","4","0","0.0","3","44.7","303.84","551.3","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3319365","2009-07-12 00:00:00.0","2","307","966","1","1","84.84","184.5","24","0","0.0","0","0.0","2036.16","4428.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3286017","2008-02-28 00:00:00.0","1","209","303","17","1","287.92","869.0","12","0","0.0","4","243.32","3455.04","10184.68","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3397618","2007-12-19 00:00:00.0","1","31","972","4","1","59.32","129.0","6","0","0.0","4","103.2","355.92","670.8","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3306016","2009-07-24 00:00:00.0","1","1","679","21","1","39.77","78.0","24","0","0.0","0","0.0","954.48","1872.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3268860","2007-01-14 00:00:00.0","1","9","2220","2","1","40.76","79.95","4","0","0.0","3","11.9925","163.04","307.8075","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3386068","2007-10-23 00:00:00.0","2","307","817","1","1","4.84","9.5","15","0","0.0","0","0.0","72.6","142.5","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"],["3366076","2009-04-15 00:00:00.0","1","101","684","1","1","73.58","160.0","10","0","0.0","0","0.0","735.8","1600.0","1","2010-01-01 00:00:00.0","2010-01-01 00:00:00.0"]]},"dateCreated":"2016-12-21T20:45:59+0000","dateStarted":"2016-12-21T20:47:06+0000","dateFinished":"2016-12-21T20:47:08+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2847"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"editorMode":"ace/mode/scala","title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482353226410_2124448796","id":"20161221-204706_856705535","dateCreated":"2016-12-21T20:47:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:2848","text":"import org.apache.spark.sql.hive.llap.LlapContext\n// Instantiate LlapContext, and use in place of HiveContext\nvar llapContext = new LlapContext(sc)\nllapContext.sql(\"select  productkey, salesamount from factsales limit 10\").show","dateUpdated":"2016-12-21T20:55:10+0000","dateFinished":"2016-12-21T20:55:26+0000","dateStarted":"2016-12-21T20:55:10+0000","title":"LlapContext in place of the HiveContext when running SparkSQL queries","result":{"code":"SUCCESS","type":"TEXT","msg":"import org.apache.spark.sql.hive.llap.LlapContext\nllapContext: org.apache.spark.sql.hive.llap.LlapContext = org.apache.spark.sql.hive.llap.LlapContext@875da29\n+----------+-----------+\n|productkey|salesamount|\n+----------+-----------+\n|      1232|   10469.52|\n|       785|       83.6|\n|      2132|     573.65|\n|      1209|     8800.0|\n|       641|     3112.4|\n|      1542|     3300.0|\n|       540|    21491.4|\n|      1641|      126.6|\n|      2209|   2736.881|\n|      1885|     7995.0|\n+----------+-----------+\n\n"},"focus":true},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true,"title":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482353423273_701322267","id":"20161221-205023_992620990","dateCreated":"2016-12-21T20:50:23+0000","status":"ERROR","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3422","dateUpdated":"2016-12-21T20:55:59+0000","dateFinished":"2016-12-21T20:55:35+0000","dateStarted":"2016-12-21T20:55:33+0000","title":"Permission denied: user [zeppelin] ","result":{"code":"ERROR","type":"TEXT","msg":"java.io.IOException: org.apache.hive.service.cli.HiveSQLException: java.io.IOException: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to compile query: org.apache.hadoop.hive.ql.security.authorization.plugin.HiveAccessControlException: Permission denied: user [zeppelin] does not have [SELECT] privilege on [default/factsales/productkey,salesamount,storekey]\n\tat org.apache.hadoop.hive.llap.LlapBaseInputFormat.getSplits(LlapBaseInputFormat.java:226)\n\tat org.apache.hadoop.hive.llap.LlapRowInputFormat.getSplits(LlapRowInputFormat.java:44)\n\tat org.apache.spark.rdd.HadoopRDD.getPartitions(HadoopRDD.scala:199)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:242)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:240)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:240)\n\tat org.apache.spark.rdd.HadoopRDD$HadoopMapPartitionsWithSplitRDD.getPartitions(HadoopRDD.scala:381)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:242)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:240)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:240)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:242)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:240)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:240)\n\tat org.apache.spark.rdd.MapPartitionsRDD.getPartitions(MapPartitionsRDD.scala:35)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:242)\n\tat org.apache.spark.rdd.RDD$$anonfun$partitions$2.apply(RDD.scala:240)\n\tat scala.Option.getOrElse(Option.scala:120)\n\tat org.apache.spark.rdd.RDD.partitions(RDD.scala:240)\n\tat org.apache.spark.sql.execution.SparkPlan.executeTake(SparkPlan.scala:190)\n\tat org.apache.spark.sql.execution.Limit.executeCollect(basicOperators.scala:165)\n\tat org.apache.spark.sql.execution.SparkPlan.executeCollectPublic(SparkPlan.scala:174)\n\tat org.apache.spark.sql.DataFrame$$anonfun$org$apache$spark$sql$DataFrame$$execute$1$1.apply(DataFrame.scala:1499)\n\tat org.apache.spark.sql.DataFrame$$anonfun$org$apache$spark$sql$DataFrame$$execute$1$1.apply(DataFrame.scala:1499)\n\tat org.apache.spark.sql.execution.SQLExecution$.withNewExecutionId(SQLExecution.scala:56)\n\tat org.apache.spark.sql.DataFrame.withNewExecutionId(DataFrame.scala:2086)\n\tat org.apache.spark.sql.DataFrame.org$apache$spark$sql$DataFrame$$execute$1(DataFrame.scala:1498)\n\tat org.apache.spark.sql.DataFrame.org$apache$spark$sql$DataFrame$$collect(DataFrame.scala:1505)\n\tat org.apache.spark.sql.DataFrame$$anonfun$head$1.apply(DataFrame.scala:1375)\n\tat org.apache.spark.sql.DataFrame$$anonfun$head$1.apply(DataFrame.scala:1374)\n\tat org.apache.spark.sql.DataFrame.withCallback(DataFrame.scala:2099)\n\tat org.apache.spark.sql.DataFrame.head(DataFrame.scala:1374)\n\tat org.apache.spark.sql.DataFrame.take(DataFrame.scala:1456)\n\tat org.apache.spark.sql.DataFrame.showString(DataFrame.scala:170)\n\tat org.apache.spark.sql.DataFrame.show(DataFrame.scala:350)\n\tat org.apache.spark.sql.DataFrame.show(DataFrame.scala:311)\n\tat org.apache.spark.sql.DataFrame.show(DataFrame.scala:319)\n\tat $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC.<init>(<console>:35)\n\tat $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC.<init>(<console>:40)\n\tat $iwC$$iwC$$iwC$$iwC$$iwC$$iwC$$iwC.<init>(<console>:42)\n\tat $iwC$$iwC$$iwC$$iwC$$iwC$$iwC.<init>(<console>:44)\n\tat $iwC$$iwC$$iwC$$iwC$$iwC.<init>(<console>:46)\n\tat $iwC$$iwC$$iwC$$iwC.<init>(<console>:48)\n\tat $iwC$$iwC$$iwC.<init>(<console>:50)\n\tat $iwC$$iwC.<init>(<console>:52)\n\tat $iwC.<init>(<console>:54)\n\tat <init>(<console>:56)\n\tat .<init>(<console>:60)\n\tat .<clinit>(<console>)\n\tat .<init>(<console>:7)\n\tat .<clinit>(<console>)\n\tat $print(<console>)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.spark.repl.SparkIMain$ReadEvalPrint.call(SparkIMain.scala:1065)\n\tat org.apache.spark.repl.SparkIMain$Request.loadAndRun(SparkIMain.scala:1346)\n\tat org.apache.spark.repl.SparkIMain.loadAndRunReq$1(SparkIMain.scala:840)\n\tat org.apache.spark.repl.SparkIMain.interpret(SparkIMain.scala:871)\n\tat org.apache.spark.repl.SparkIMain.interpret(SparkIMain.scala:819)\n\tat sun.reflect.GeneratedMethodAccessor27.invoke(Unknown Source)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.zeppelin.spark.Utils.invokeMethod(Utils.java:38)\n\tat org.apache.zeppelin.spark.SparkInterpreter.interpret(SparkInterpreter.java:717)\n\tat org.apache.zeppelin.spark.SparkInterpreter.interpretInput(SparkInterpreter.java:928)\n\tat org.apache.zeppelin.spark.SparkInterpreter.interpret(SparkInterpreter.java:871)\n\tat org.apache.zeppelin.spark.SparkInterpreter.interpret(SparkInterpreter.java:864)\n\tat org.apache.zeppelin.interpreter.LazyOpenInterpreter.interpret(LazyOpenInterpreter.java:94)\n\tat org.apache.zeppelin.interpreter.remote.RemoteInterpreterServer$InterpretJob.jobRun(RemoteInterpreterServer.java:341)\n\tat org.apache.zeppelin.scheduler.Job.run(Job.java:176)\n\tat org.apache.zeppelin.scheduler.FIFOScheduler$1.run(FIFOScheduler.java:139)\n\tat java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)\n\tat java.util.concurrent.FutureTask.run(FutureTask.java:266)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)\n\tat java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)\n\tat java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)\n\tat java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)\n\tat java.lang.Thread.run(Thread.java:745)\nCaused by: org.apache.hive.service.cli.HiveSQLException: java.io.IOException: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to compile query: org.apache.hadoop.hive.ql.security.authorization.plugin.HiveAccessControlException: Permission denied: user [zeppelin] does not have [SELECT] privilege on [default/factsales/productkey,salesamount,storekey]\n\tat org.apache.hive.jdbc.Utils.verifySuccess(Utils.java:256)\n\tat org.apache.hive.jdbc.Utils.verifySuccessWithInfo(Utils.java:242)\n\tat org.apache.hive.jdbc.HiveQueryResultSet.next(HiveQueryResultSet.java:365)\n\tat org.apache.hadoop.hive.llap.LlapBaseInputFormat.getSplits(LlapBaseInputFormat.java:218)\n\t... 82 more\nCaused by: org.apache.hive.service.cli.HiveSQLException: java.io.IOException: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to compile query: org.apache.hadoop.hive.ql.security.authorization.plugin.HiveAccessControlException: Permission denied: user [zeppelin] does not have [SELECT] privilege on [default/factsales/productkey,salesamount,storekey]\n\tat org.apache.hive.service.cli.operation.SQLOperation.getNextRowSet(SQLOperation.java:487)\n\tat org.apache.hive.service.cli.operation.OperationManager.getOperationNextRowSet(OperationManager.java:308)\n\tat org.apache.hive.service.cli.session.HiveSessionImpl.fetchResults(HiveSessionImpl.java:844)\n\tat org.apache.hive.service.cli.CLIService.fetchResults(CLIService.java:504)\n\tat org.apache.hive.service.cli.thrift.ThriftCLIService.FetchResults(ThriftCLIService.java:701)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$FetchResults.getResult(TCLIService.java:1717)\n\tat org.apache.hive.service.rpc.thrift.TCLIService$Processor$FetchResults.getResult(TCLIService.java:1702)\n\tat org.apache.thrift.ProcessFunction.process(ProcessFunction.java:39)\n\tat org.apache.thrift.TBaseProcessor.process(TBaseProcessor.java:39)\n\tat org.apache.hive.service.auth.TSetIpAddressProcessor.process(TSetIpAddressProcessor.java:56)\n\tat org.apache.thrift.server.TThreadPoolServer$WorkerProcess.run(TThreadPoolServer.java:286)\n\t... 3 more\nCaused by: java.io.IOException: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to compile query: org.apache.hadoop.hive.ql.security.authorization.plugin.HiveAccessControlException: Permission denied: user [zeppelin] does not have [SELECT] privilege on [default/factsales/productkey,salesamount,storekey]\n\tat org.apache.hadoop.hive.ql.exec.FetchTask.fetch(FetchTask.java:164)\n\tat org.apache.hadoop.hive.ql.Driver.getResults(Driver.java:1897)\n\tat org.apache.hive.service.cli.operation.SQLOperation.getNextRowSet(SQLOperation.java:482)\n\t... 13 more\nCaused by: org.apache.hadoop.hive.ql.metadata.HiveException: Failed to compile query: org.apache.hadoop.hive.ql.security.authorization.plugin.HiveAccessControlException: Permission denied: user [zeppelin] does not have [SELECT] privilege on [default/factsales/productkey,salesamount,storekey]\n\tat org.apache.hadoop.hive.ql.udf.generic.GenericUDTFGetSplits.createPlanFragment(GenericUDTFGetSplits.java:234)\n\tat org.apache.hadoop.hive.ql.udf.generic.GenericUDTFGetSplits.process(GenericUDTFGetSplits.java:190)\n\tat org.apache.hadoop.hive.ql.exec.UDTFOperator.process(UDTFOperator.java:116)\n\tat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:879)\n\tat org.apache.hadoop.hive.ql.exec.SelectOperator.process(SelectOperator.java:95)\n\tat org.apache.hadoop.hive.ql.exec.Operator.forward(Operator.java:879)\n\tat org.apache.hadoop.hive.ql.exec.TableScanOperator.process(TableScanOperator.java:130)\n\tat org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:438)\n\tat org.apache.hadoop.hive.ql.exec.FetchOperator.pushRow(FetchOperator.java:430)\n\tat org.apache.hadoop.hive.ql.exec.FetchTask.fetch(FetchTask.java:146)\n\t... 15 more\n\n"},"text":"llapContext.sql(\"select storekey, productkey, salesamount from factsales limit 10\").show"},{"config":{"colWidth":12,"graph":{"mode":"table","height":300,"optionOpen":false,"keys":[],"values":[],"groups":[],"scatter":{}},"enabled":true},"settings":{"params":{},"forms":{}},"jobName":"paragraph_1482353400533_-933337892","id":"20161221-205000_1431001842","dateCreated":"2016-12-21T20:50:00+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3349"}],"name":"SKO/LLAP_Demo","id":"2C6FNY2Z7","angularObjects":{"2C3N3W5W6:shared_process":[],"2C6RRCZQ4:shared_process":[],"2C5R46VED:shared_process":[],"2C3HXMGG8:shared_process":[],"2C4PQ3FEA:shared_process":[],"2C6M4A4JU:shared_process":[]},"config":{"looknfeel":"default"},"info":{}}